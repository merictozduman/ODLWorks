
CREATE TABLE REPLACEMENT_TABLE 
   (	SUBJECT VARCHAR2(50), 
	STEP_NAME VARCHAR2(50), 
	RUN_ORDER NUMBER, 
	SEARCH_STRING VARCHAR2(100), 
	REPLACE_STRING VARCHAR2(100)
   )


INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP4', 1, '00900', 'x');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP4', 2, '0090', 'x');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP4', 3, '009', 'x');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP4', 4, '090', 'x');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP4', 5, '90', 'x');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP4', 6, '000', 'x');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP4', 7, '0', 'x');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 1, '@@', '@');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 2, ',@', '@');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 3, 'HOTMAIL', 'HOTMAIL.COM');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 4, 'HOTMAİL', 'HOTMAIL.COM');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 5, 'HOTMAİLCOM', 'HOTMAIL.COM');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 6, 'HOTMAILCOM', 'HOTMAIL.COM');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 7, 'GMAİL', 'GMAIL.COM');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 8, '.coom', '.com');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 9, 'superonline', 'superonline.com');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 10, 'yahoo', 'yahoo.com');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 11, 'mynet', 'mynet.com');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 12, 'gmail', 'gmail.com');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 13, 'hotmail', 'hotmail.com');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 14, 'gmail', 'gmail.com');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 15, 'hotmailcom', 'hotmail.com');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 16, 'ş', 's');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 17, 'Ş', 's');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 18, 'ü', 'u');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 19, 'Ü', 'u');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 20, 'ğ', 'g');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 21, 'Ğ', 'g');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 22, 'ö', 'o');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 23, 'Ö', 'o');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 24, 'ı', 'i');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 25, 'İ', 'i');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 26, 'ç', 'c');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 27, 'Ç', 'c');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 28, 'comtr', 'com.tr');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 29, 'com.com', 'com');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('MAIL', 'STEP1', 30, 'COM.COM', 'COM');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-3', 1, '--', '-');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-3', 1, '---', '-');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-3', 1, '----', '-');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-3', 1, '-----', '-');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-3', 1, '------', '-');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'İ', 'I');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'i', 'I');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'Ü', 'U');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'ü', 'U');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'ç', 'C');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'Ç', 'C');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'Ş', 'S');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'ş', 'S');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'ğ', 'G');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'Ğ', 'G');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'ö', 'O');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-1', 1, 'Ö', 'O');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-2', 1, '(', '-');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-2', 1, ')', '-');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-2', 1, '-', '-');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-2', 1, '/', '-');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-2', 1, '\', '-');
INSERT INTO REPLACEMENT_TABLE
(SUBJECT, STEP_NAME, RUN_ORDER, SEARCH_STRING, REPLACE_STRING)
VALUES('PHONE', 'STEP1-2' 1, '+', '-');   

----------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE FUNCTION QLICK.REPLACE_STRING_BY_TBL(
p_subject_name IN VARCHAR2,   
p_step_name   IN VARCHAR2,
p_input_string IN VARCHAR2
) RETURN VARCHAR2
AS
  v_search_string  VARCHAR2(100);
  v_replace_string VARCHAR2(100);
  v_stg_input_string VARCHAR2(100);
BEGIN
  --  dbms_output.put_line('START-subject_name := '||p_subject_name);
  --  dbms_output.put_line('START-step_name := '||p_step_name);
  --  dbms_output.put_line('START-input_string := '||p_input_string );
	
  v_stg_input_string:=	p_input_string;
  -- Declare a cursor to select rows based on step_name
  FOR c IN (SELECT search_string, replace_string
            FROM replacement_table
            WHERE 1=1 
            AND step_name =p_step_name
            AND subject = p_subject_name
            ORDER BY run_order asc)
  LOOP
    -- Fetch values from the cursor
    v_search_string := c.search_string;
    v_replace_string := c.replace_string;

    -- Perform the replacement for each row
    v_stg_input_string := REPLACE(v_stg_input_string, v_search_string, v_replace_string);
    
--    dbms_output.put_line('v_search_string := '||v_search_string);
--    dbms_output.put_line('v_replace_string := '||v_replace_string);
--    dbms_output.put_line('v_stg_input_string := '||v_stg_input_string );
  END LOOP;
    
  -- Return the final result
  RETURN v_stg_input_string;
END REPLACE_STRING_BY_TBL;

----------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE PROCEDURE QLICK.PRC_PHN_PROCESS_NUMBER(
    in_telefon_numarasi  IN  VARCHAR2,
    std_tel_no OUT VARCHAR2,
    std_tel_no_s OUT VARCHAR2,
    lbl_tel_no OUT VARCHAR2
) AS
    TYPE StringArray IS TABLE OF VARCHAR2(10);
    Lab_TELNO varchar2(300);
    strings_to_add StringArray := StringArray(
    '00900',   '0090',  '900','0900', '009', '090', '90', '000', '00', '0', 
    '+00900', '+0090', '+900','+0900','+009', '+090', '+90', '+9' );
    /*
    StringArray('00900', '0090', '009', '090', '90', '000', '00', '0', '+00900', '+0090', '+009', '+090', '+90', '+9'
    ,'900','0900','+900','+0900');--ikinci satırdan itibaren benim eklediklerim.*/
    n NUMBER;
BEGIN
     
	  ---türkçe harf değişimi
      Lab_TELNO  := REPLACE_STRING_BY_TBL('PHONE','STEP1-1',FNC_TRIM(in_telefon_numarasi));
	  dbms_output.put_line('türkçe harf değişimi: '|| Lab_TELNO  );
    
	 --english alphabet özel karakter değişimi
	  Lab_TELNO  := LIST_REPLACE(FNC_TRIM( Lab_TELNO)
  												 ,'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&''*,.:;<=>?[]^_`{|}~'
  	                                     		 ,'@');
      dbms_output.put_line('english alphabet özel karakter değişimi: '|| Lab_TELNO  );
  	 
     --english alphabet özel karakter değişimi                                    		
     std_tel_no  := REPLACE( Lab_TELNO,'@',null) ;
      dbms_output.put_line('english alphabet özel karakter değişimi @: '|| std_tel_no  );
     
     --remove -> ()-/\ scope: start
     IF substr(std_tel_no,1,1) IN ('(',')','-','/','\') THEN
	   std_tel_no:=substr(std_tel_no,2,LENGTH(std_tel_no));
	 END IF;  
	dbms_output.put_line('remove -> ()-/\ scope: start: '|| std_tel_no  );
    
	--replace with x ->00900,0090,009,090,90,000,00,0,+00900,+0090,+009,+090,+90,+9 scope start
    FOR i IN 1..strings_to_add.COUNT LOOP
        n := LENGTH(strings_to_add(i));      
        IF SUBSTR(std_tel_no, 1, n) = strings_to_add(i) THEN
            std_tel_no := 'x' || SUBSTR(std_tel_no, n+1);
        END IF;
    END LOOP;
   	dbms_output.put_line('replace with x ->00900,0090,009,090... '|| std_tel_no  );
 
            --remove -> + scope: start
     IF substr(std_tel_no,1,1) IN ('+') THEN
	   std_tel_no:=substr(std_tel_no,2,LENGTH(std_tel_no));
	 END IF;  
    dbms_output.put_line('remove -> + scope: start: '|| std_tel_no  );
   
	--remove ->()-/\+ scope: end
	IF substr(std_tel_no,-1) IN ('(',')','-','/','\','+')  THEN
	   std_tel_no:=substr(std_tel_no,1,LENGTH(std_tel_no)-1);
	END IF;  
    dbms_output.put_line('remove ->()-/\+ scope: end: '|| std_tel_no  );	

   --replace with '-'  ->   ()-/\+ scope: anywhere
   std_tel_no  := REPLACE_STRING_BY_TBL('PHONE','STEP1-2',FNC_TRIM(std_tel_no));
   dbms_output.put_line('replace with -  ->   ()-/\+ scope: anywhere: '|| std_tel_no  );	
      
   --replace: '-' -> ------,-----,----,---,-- scope anywhere 
   std_tel_no  := REPLACE_STRING_BY_TBL('PHONE','STEP1-3',FNC_TRIM(std_tel_no)); 
   dbms_output.put_line('replace: - -> ------,-----,----,---,-- scope anywhere : '|| std_tel_no  );	
  
    --remove '-' scope start
   	IF substr(std_tel_no,1,1)='-' THEN
	   std_tel_no :=substr(std_tel_no  ,2,LENGTH(std_tel_no ));
	END IF;  
    dbms_output.put_line('remove - scope start '|| std_tel_no  );	

   --remove '-' scope end
	IF substr(std_tel_no ,-1)='-' THEN
	   std_tel_no :=substr(std_tel_no ,1,LENGTH(std_tel_no )-1);
	END IF;  
    dbms_output.put_line('remove - scope end '|| std_tel_no  );	

   --replace :'x-'->'x' ile değiştir. scope start. 
   IF substr(std_tel_no,1,2)='x-' THEN
      std_tel_no:=REPLACE(std_tel_no,'x-','x');
   END IF;
   dbms_output.put_line('replace :x-->x ile değiştir. scope start. '|| std_tel_no  );	 

   lbl_tel_no  := LIST_REPLACE(std_tel_no,'0123456789','d') ;
  -- std_tel_no  := std_tel_no 
   std_tel_no_s:= LIST_REPLACE(std_tel_no,'x-()\/',NULL);
END ;

----------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE PROCEDURE QLICK.PRC_PHN_MOBILEHOME_CHCK(
    p_std_tel_no IN VARCHAR2,
    lbl_alan_kodu1 OUT VARCHAR2,
    lbl_alan_kodu2 OUT VARCHAR2
)
IS
BEGIN
	

        IF QLICK.FNC_SEARCH_IN_TABLE('DIC_ALLIANZ_CEP_ALAN_KOD','AREACODE1',SUBSTR(p_std_tel_no, 1, 3))=1 THEN 
           lbl_alan_kodu1:='cep' ;
        END IF;  
                         
        IF QLICK.FNC_SEARCH_IN_TABLE('DIC_ALLIANZ_SABIT_ALAN_KOD','AREACODE1',SUBSTR(p_std_tel_no, 1, 3))=1 THEN 
           lbl_alan_kodu1:='ev' ;
        END IF;  
    
	
        IF QLICK.FNC_SEARCH_IN_TABLE('DIC_ALLIANZ_CEP_ALAN_KOD','AREACODE1',SUBSTR(p_std_tel_no, 8, 3))=1  THEN
           lbl_alan_kodu2:='cep'; 
        END IF;
       
        IF QLICK.FNC_SEARCH_IN_TABLE('DIC_ALLIANZ_SABIT_ALAN_KOD','AREACODE1',SUBSTR(p_std_tel_no, 8, 3))=1 THEN
           lbl_alan_kodu2:='ev'; 
        END IF;

       
END PRC_PHN_MOBILEHOME_CHCK;

----------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE procedure QLICK.PRC_PHN_EXTENSION_CHCK
   ( 
   in_telefon_numarasi IN varchar2,
    hat_flag OUT NUMBER,
    dahili_flag OUT NUMBER
     )
IS
vStgString1 varchar2(300);
BEGIN

	vStgString1:=LIST_REPLACE(FNC_TRIM(in_telefon_numarasi)
  												 ,'0123456789!"#$%&''()*+,-./:;<=>?[\]^_`{|}~'
  	                                     		 ,null);  	                                     		
IF vStgString1 IS NULL THEN
 hat_flag:=0;
 dahili_flag :=0;
  ELSE 	
		IF FNC_SEARCH_EXTENSION(vStgString1)='1' THEN
	       hat_flag:=1;
	    else  
	        hat_flag:=0;
	    END IF;
	
		IF FNC_SEARCH_EXTENSION(vStgString1)='0' THEN
	       dahili_flag :=1;
	    else  
	        dahili_flag :=0;
	    END IF; 
END IF;
    
    
end ;

----------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE procedure QLICK.PRC_PHN_DECISION
   ( 
lbl_tel_no IN varchar2,
std_tel_no IN  varchar2, 
std_tel_no_s IN  varchar2,
lbl_alan_kodu1 IN varchar2, 
lbl_alan_kodu2  IN varchar2,
dahili_flag IN NUMBER,
hat_flag IN NUMBER,
dec_telefon_no1 OUT VARCHAR2,
dec_telefon_no2 OUT VARCHAR2, 
dec_telefon_no3 OUT VARCHAR2,
dec_dahili_no OUT VARCHAR2
     )
IS
BEGIN
	 
	--std_tel_no:=std_tel_no_for_decision;
	
	
IF LENGTH(std_tel_no_s)<7 THEN --std_tel_no_s
        
        dec_telefon_no1    := '';
        dec_telefon_no2    := '';
        dec_telefon_no3    := '';
        dec_dahili_no      := '';

ELSE

			IF lbl_tel_no='dddddddddd' and dahili_flag=0  THEN
					
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
			
			ELSIF	lbl_tel_no='dddddddddd' and dahili_flag=1  THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,8,3);	
			
			ELSIF	 lbl_tel_no='xdddddddddd' THEN
					  
					 dec_telefon_no1   := SUBSTR(std_tel_no,2,10);
			         dec_telefon_no2   := '';
			         dec_telefon_no3   := '';
			         dec_dahili_no     := '';
					
			ELSIF	lbl_tel_no='ddddddd'  THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
			
			ELSIF	 lbl_tel_no='ddd-ddddddd' THEN
					  
					 dec_telefon_no1   := SUBSTR(std_tel_no,1,3) || SUBSTR(std_tel_no,5,7);
			         dec_telefon_no2   := '';
			         dec_telefon_no3   := '';
			         dec_dahili_no     := '';		
					 
					
			ELSIF	lbl_tel_no='ddddddddddd'  THEN
					
					IF dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,8,4);
					
					ELSIF hat_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					
					ELSE
					dec_telefon_no1    := '';
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					END IF;
			
			ELSIF	 lbl_tel_no='xddd-ddddddd' THEN
					  
					 dec_telefon_no1   := substr(std_tel_no,2,3) || substr(std_tel_no,6,7);
			         dec_telefon_no2   := '';
			         dec_telefon_no3   := '';
			         dec_dahili_no     := '';	
			
			ELSIF	 lbl_tel_no='ddddddddd' THEN
					 IF  hat_flag=1 THEN
					 dec_telefon_no1   := substr(std_tel_no,1,7);
			         dec_telefon_no2   := '';
			         dec_telefon_no3   := '';
			         dec_dahili_no     := '';	
					 ELSE
					 dec_telefon_no1   := '';
			         dec_telefon_no2   := '';
			         dec_telefon_no3   := '';
			         dec_dahili_no     := '';		
					 END IF;
					 	
			ELSIF	lbl_tel_no='dddddddddddd'  THEN
					IF hat_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
					ELSE 
					dec_telefon_no1    := '';
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';			
					END IF;
				
			ELSIF	lbl_tel_no='dddddddddddddd' THEN
					IF dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,11,4);	
					ELSE
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := substr(std_tel_no,8,7);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
					END IF;
					
			ELSIF	lbl_tel_no='ddddddddddddd' THEN
					IF dahili_flag=1 THEN 
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,11,3);		
					ELSE
					dec_telefon_no1    := '';
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					END IF;
			
					
			ELSIF 	lbl_tel_no='xddddddddddddd'	THEN
					IF dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,12,3);
					ELSE
					dec_telefon_no1    := '';
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
					END IF;
			
			ELSIF	 lbl_tel_no='xddd-ddd-dd-dd' THEN
					  
					 dec_telefon_no1   := substr(std_tel_no,2,3)||substr(std_tel_no,6,3)||substr(std_tel_no,10,2)|| substr(std_tel_no,13,2); 
			         dec_telefon_no2   := '';
			         dec_telefon_no3   := '';
			         dec_dahili_no     := '';			
					
			
			ELSIF 	lbl_tel_no='ddddddddddddddd' THEN
					IF dahili_flag=1 THEN 
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,11,5);
					ELSE
					dec_telefon_no1    := '';
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					END IF;
					
			ELSIF	 lbl_tel_no='dddddddddd-dddddddddd' THEN					  
					 dec_telefon_no1   := substr(std_tel_no,1,10);
			         dec_telefon_no2   := substr(std_tel_no,12,10);
			         dec_telefon_no3   := '';
			         dec_dahili_no     := '';	
					
			ELSIF 	lbl_tel_no='dddddddd'	THEN
					IF dahili_flag=1 THEN 
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,8,1);
					ELSIF hat_flag=1 THEN 
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					ELSE
					dec_telefon_no1    := '';
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					END IF; 
			
			ELSIF 	lbl_tel_no='xddddddddddd'	THEN
					IF  hat_flag=1 THEN 
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					ELSE
					dec_telefon_no1    := '';
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					END IF ;
					
			ELSIF 	lbl_tel_no='xddddddd'	THEN			
					dec_telefon_no1    := substr(std_tel_no,2,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
			
			ELSIF 	lbl_tel_no='ddddddd-ddddddd'	THEN			
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := substr(std_tel_no,9,7);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
					
			ELSIF 	lbl_tel_no='dddddddddd-dd'	THEN	
					IF dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,12,2);	
					ELSE
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := substr(std_tel_no,1,8) || substr(std_tel_no,12,2);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
					END IF;
					
			ELSIF 	lbl_tel_no='xdddddddddddd'	THEN
			
					IF dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,12,2);	
					ELSE
					dec_telefon_no1    := '';
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
					END IF;
			
			ELSIF 	lbl_tel_no='dddddddddd-dddd'	THEN			
					IF substr(std_tel_no,1,1)<>'5'  THEN
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,12,4);	
					ELSE
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
					END IF;
					
			ELSIF 	lbl_tel_no='dddddddddd-ddd'	THEN			
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,12,3);	
			
			
			ELSIF 	lbl_tel_no='xdddddddddd-ddddddd'	THEN			
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := substr(std_tel_no,13,7);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
			
			ELSIF 	lbl_tel_no='xdddddddddd-ddddddddddd' THEN			
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := substr(std_tel_no,14,10);	
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
						
			ELSIF 	lbl_tel_no='xdddddddddd-ddd' THEN	
					IF  hat_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := substr(std_tel_no,2,8) || substr(std_tel_no,13,2);	
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					ELSE
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,13,3);	
					END IF;
					
			ELSIF  lbl_tel_no = 'xdddddddddd-dddd' THEN
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,13,4);		
					
			ELSIF 	lbl_tel_no = 'dddddddddd-ddddddd' THEN			
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := substr(std_tel_no,12,7);	
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
			
			ELSIF 	lbl_tel_no='ddddddd-ddddddddddd' THEN
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := substr(std_tel_no,10,10);	
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
						
			ELSIF 	lbl_tel_no='dddddddddddddddddd' THEN
					IF substr(std_tel_no,8,1)='0' THEN
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := substr(std_tel_no,9,10);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
					ELSE 
					dec_telefon_no1    := '';
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					END IF;
					
			ELSIF 	lbl_tel_no='xdddddddddd-dd' THEN
					IF dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,13,2);	
					ELSIF hat_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					ELSE 
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := substr(std_tel_no,2,8) || substr(std_tel_no,13,2);		
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					END IF;
			
			ELSIF 	lbl_tel_no='ddddddd-ddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,9,3);
			
				
			ELSIF 	lbl_tel_no='ddd-ddd-dd-dd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,3) || substr(std_tel_no,5,3) || substr(std_tel_no,9,2) || substr(std_tel_no,12,2);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
					
					
			ELSIF 	lbl_tel_no='ddddddd-dd' THEN
					IF dahili_flag=1  THEN
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,9,2);		
					ELSIF hat_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
					ELSE
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := substr(std_tel_no,1,5) || substr(std_tel_no,9,2);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
					END IF;
					
			ELSIF 	lbl_tel_no='ddddddd-dddddddddd' THEN
					IF dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := substr(std_tel_no,9,7);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,16,3);
					ELSE
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := substr(std_tel_no,9,10);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					END IF;
					
			ELSIF 	lbl_tel_no='xddddddddddddddddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := substr(std_tel_no,12,7);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					
			ELSIF 	lbl_tel_no='dddddddddddddddddddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := substr(std_tel_no,11,10);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
			
			ELSIF 	lbl_tel_no='ddd-dd-dd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,3) || substr(std_tel_no,5,2) || substr(std_tel_no,8,2);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
					
			ELSIF 	lbl_tel_no='dddddddddd-ddddddddddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := substr(std_tel_no,13,10);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
			
			ELSIF 	lbl_tel_no='xddddddddddddddddddddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := substr(std_tel_no,13,10);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
					
			ELSIF 	lbl_tel_no='ddd-ddddddd-ddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,3) || substr(std_tel_no,5,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,13,3);	
			
			ELSIF 	lbl_tel_no='ddddddd-ddddddd-dddddddddd'  THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := substr(std_tel_no,9,7);
			        dec_telefon_no3    := substr(std_tel_no,17,10);
			        dec_dahili_no      := '';			
			
			ELSIF 	lbl_tel_no='xdd-ddddddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,5,7); 
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
			
			ELSIF 	lbl_tel_no='xdddddddddddddd' THEN
					IF substr(std_tel_no,2,1)='5' THEN
					dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					ELSE
					dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,12,4);
					END IF;
					
			ELSIF 	lbl_tel_no='ddd-ddddddd-dddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,3) || substr(std_tel_no,5,7); 
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := ''; 
			        dec_dahili_no      := substr(std_tel_no,13,4); 	
					
			ELSIF 	lbl_tel_no='xdddddddddd-ddddddd-ddddddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := substr(std_tel_no,13,7); 
			        dec_telefon_no3    := substr(std_tel_no,21,7); 
			        dec_dahili_no      := '';	
			
			ELSIF 	lbl_tel_no='ddddddddddddddddddddd' THEN
					IF substr(std_tel_no,11,1)<>'0' and dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := substr(std_tel_no,11,7);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,18,4);		
					ELSIF substr(std_tel_no,8,1)='0' and dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := substr(std_tel_no,8,10);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,18,4);	
					ELSIF	substr(std_tel_no,11,1)='0' THEN
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := substr(std_tel_no,12,10);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					ELSE 
					dec_telefon_no1    := '';
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					END IF;		
					
			ELSIF 	lbl_tel_no='ddddddd-ddddddd-ddddddddddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,7); 
			        dec_telefon_no2    := substr(std_tel_no,9,7); 
			        dec_telefon_no3    := substr(std_tel_no,18,10); 
			        dec_dahili_no      := '';			
			
			ELSIF 	lbl_tel_no='dddddddddd-d' THEN
					IF hat_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,10) ;
			        dec_telefon_no2    := '' ;
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
					ELSE
					dec_telefon_no1    := substr(std_tel_no,1,10) ;
			        dec_telefon_no2    := substr(std_tel_no,1,9) || substr(std_tel_no,12,1);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
					END IF;
					
			ELSIF 	lbl_tel_no='ddd-ddddddd-ddddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,3) || substr(std_tel_no,5,7); 
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
			
			ELSIF 	lbl_tel_no='dddddddddd-ddddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
			
			ELSIF 	lbl_tel_no='ddd-ddd-dddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,3) || substr(std_tel_no,5,3) || substr(std_tel_no,9,4) ;
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
			
			ELSIF 	lbl_tel_no='xddd-ddddddd-ddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,2,3) || substr(std_tel_no,6,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,14,3);
								
			ELSIF 	lbl_tel_no='xddd-ddddddd-ddddddd' THEN
					dec_telefon_no1    := substr(std_tel_no,2,3) || substr(std_tel_no,6,7);
			        dec_telefon_no2    := substr(std_tel_no,14,7);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
					
					
			ELSIF 	lbl_tel_no='xdddddddddd-dddddddddd' and dahili_flag=0 THEN
			
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := substr(std_tel_no,13,10);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
			
			ELSIF 	lbl_tel_no='dddddddddd-dd-dd'	 THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := substr(std_tel_no,1,8) || substr(std_tel_no,12,2);
			        dec_telefon_no3    := substr(std_tel_no,1,8) || substr(std_tel_no,15,2);
			        dec_dahili_no      := '';	
			
			ELSIF 	lbl_tel_no='xddd-ddddddd-dddd'  THEN
					dec_telefon_no1    := substr(std_tel_no,2,3) || substr(std_tel_no,6,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,14,4);	
				
			ELSIF 	lbl_tel_no='xdddddddddd-ddddd'   THEN
					IF substr(std_tel_no,2,1)<>'5' THEN
					dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,13,5);	
					ELSE
					dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';			
					END IF;
				
			ELSIF 	lbl_tel_no='xdddddddddd-d'	 THEN
					IF dahili_flag=1    THEN
					dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,13,1); 	
					ELSIF hat_flag=1	THEN
					dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
					ELSE
					dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := substr(std_tel_no,2,9) || substr(std_tel_no,13,1); 
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
					END IF;
					
			ELSIF 	lbl_tel_no='xddd-ddddddd-dd'	 THEN
			
					dec_telefon_no1    := substr(std_tel_no,2,3) || substr(std_tel_no,6,7);
			        dec_telefon_no2    := substr(std_tel_no,2,3) || substr(std_tel_no,6,5) || substr(std_tel_no,14,2); 
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';			
								
			ELSIF 	lbl_tel_no='ddd-ddddddd-dd'	 THEN
					IF hat_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,3) || substr(std_tel_no,5,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';
					ELSIF dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,3) || substr(std_tel_no,5,7);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,13,2); 
					ELSE
					dec_telefon_no1    := substr(std_tel_no,1,3) || substr(std_tel_no,5,7);
			        dec_telefon_no2    := substr(std_tel_no,1,3) || substr(std_tel_no,5,5) || substr(std_tel_no,13,2); 
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';			
					END IF;
					
			ELSIF 	lbl_tel_no='x-ddd-ddd-dddd'	 THEN
			
					dec_telefon_no1    := substr(std_tel_no,3,3) || substr(std_tel_no,7,3) || substr(std_tel_no,11,4);
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
					
			ELSIF 	lbl_tel_no='xdddddddddddddddddddd'	  THEN
					IF dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := substr(std_tel_no,12,7);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,19,3);	
					ELSE
					dec_telefon_no1    := substr(std_tel_no,2,10);
			        dec_telefon_no2    := substr(std_tel_no,12,7);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';		
					END IF;
					
			ELSIF 	lbl_tel_no='dddddddddd-ddddddd-dddddddddd'		 THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,10);
			        dec_telefon_no2    := substr(std_tel_no,12,7);
			        dec_telefon_no3    := substr(std_tel_no,20,10);
			        dec_dahili_no      := '';
			
			ELSIF 	lbl_tel_no='ddd-ddddddd-ddddddd' THEN
			
					dec_telefon_no1    := substr(std_tel_no,1,3) || substr(std_tel_no,5,7);
			        dec_telefon_no2    := substr(std_tel_no,13,7);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
			
			ELSIF 	lbl_tel_no='dddddddddd-ddddddd-ddddddd'   THEN
					dec_telefon_no1    := substr(std_tel_no,1,10); 
			        dec_telefon_no2    := substr(std_tel_no,12,7);
			        dec_telefon_no3    := substr(std_tel_no,20,7);	
			        dec_dahili_no      := '';			
			
			ELSIF 	lbl_tel_no= 'xdddddddddd-dd-dd'	  THEN
					dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := substr(std_tel_no,2,8) || substr(std_tel_no,13,2);
			        dec_telefon_no3    := substr(std_tel_no,2,8) || substr(std_tel_no,16,2);	
			        dec_dahili_no      := '';	
			
			ELSIF lbl_tel_no= 'xddd-ddd-dddd'	  THEN
					dec_telefon_no1    := substr(std_tel_no,2,3) || substr(std_tel_no,6,3)  || substr(std_tel_no,10,4); 
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
					
			ELSIF lbl_tel_no= 'xdddddddddd-ddddddddddd-ddddddddddd' THEN
					dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := substr(std_tel_no,14,10); 
			        dec_telefon_no3    := substr(std_tel_no,26,10); 
			        dec_dahili_no      := '';	
			
			ELSIF 	lbl_tel_no='ddddddd-dd-dd'  THEN
					IF dahili_flag=1 THEN
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := substr(std_tel_no,1,5) || substr(std_tel_no,9,2);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,12,2);	
					ELSE
					dec_telefon_no1    := substr(std_tel_no,1,7);
			        dec_telefon_no2    := substr(std_tel_no,1,5) || substr(std_tel_no,9,2);
			        dec_telefon_no3    := substr(std_tel_no,1,5) || substr(std_tel_no,12,2);
			        dec_dahili_no      := '';		
					END IF;		
			ELSIF lbl_tel_no='xdddddddddd-dd-ddd' THEN
				   	dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := substr(std_tel_no,2,8) || substr(std_tel_no,13,2); 
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,16,3); 	
					
			ELSIF lbl_tel_no='dddddddddd-ddddddd-ddddddddddd'		THEN
					dec_telefon_no1    := substr(std_tel_no,1,10); 
			        dec_telefon_no2    := substr(std_tel_no,12,7);
			        dec_telefon_no3    := substr(std_tel_no,21,10); 
			        dec_dahili_no      := '';
			
			ELSIF lbl_tel_no='xdddddddddd-ddddddd-dddd'		THEN
					dec_telefon_no1    := substr(std_tel_no,2,10); 
			        dec_telefon_no2    := substr(std_tel_no,13,7);
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,21,4); 
			
			ELSIF lbl_tel_no='ddd-dddddddddd'		THEN
					dec_telefon_no1    := substr(std_tel_no,1,3)  || substr(std_tel_no,5,7); 
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := substr(std_tel_no,12,3); 	
					
			ELSIF lbl_tel_no='ddddddddddddddddd' THEN 
					IF lbl_alan_kodu1='cep' THEN
			
					dec_telefon_no1    := SUBSTR(std_tel_no,1,10);
					dec_telefon_no2    := SUBSTR(std_tel_no,11,7);
					dec_telefon_no3    := '';
					dec_dahili_no      := '';
					
					ELSIF lbl_alan_kodu2='cep' THEN
			
					dec_telefon_no1	   := SUBSTR(std_tel_no,1,7);
					dec_telefon_no2    := SUBSTR(std_tel_no,8,10);
					dec_telefon_no3    := '';
					dec_dahili_no      := '';
					
					ELSIF lbl_alan_kodu1='ev' THEN
			 
					dec_telefon_no1	   :=SUBSTR(std_tel_no,1,10);
					dec_telefon_no2    :=SUBSTR(std_tel_no,11,7);
					dec_telefon_no3    := '';
					dec_dahili_no      := '';
					
					ELSIF lbl_alan_kodu2='ev' THEN
			
					dec_telefon_no1	   := SUBSTR(std_tel_no,1,7);
					dec_telefon_no2    := SUBSTR(std_tel_no,8,10);
					dec_telefon_no3    := '';
					dec_dahili_no      := '';
					
					ELSE
					dec_telefon_no1	   := '';
					dec_telefon_no2    := '';
					dec_telefon_no3    := '';
					dec_dahili_no      := '';           
					END IF;
				
			ELSE	
			 
					dec_telefon_no1    := '';
			        dec_telefon_no2    := '';
			        dec_telefon_no3    := '';
			        dec_dahili_no      := '';	
			         
			END IF;
 
END IF	;	

end ;

----------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE PROCEDURE QLICK.PRC_PHN_MAIN_PROCESS(
    in_telefon_numarasi IN VARCHAR2,
    dec_dahili_no_out OUT VARCHAR2,
    telno1 OUT VARCHAR2,
    telno2 OUT VARCHAR2,
    telno3 OUT VARCHAR2
)
IS
    std_tel_no VARCHAR2(300);
    std_tel_no_s VARCHAR2(300);
    lbl_tel_no VARCHAR2(300);
    lbl_alan_kodu1 VARCHAR2(50);
    lbl_alan_kodu2 VARCHAR2(50);
    hat_flag NUMBER;
    dahili_flag NUMBER;
    dec_dahili_no_in VARCHAR2(300);
    dec_telefon_no1 VARCHAR2(300);
    dec_telefon_no2 VARCHAR2(300);
    dec_telefon_no3 VARCHAR2(300);
BEGIN
    -- trimliyoruz,özel karakterleri çıkatıyoruz. Rakamsal hali std_tel_no içinde xddddddd formatı lbl_tel_no içinde
    QLICK.PRC_PHN_PROCESS_NUMBER(in_telefon_numarasi, std_tel_no,  std_tel_no_s,lbl_tel_no);
    dbms_output.put_line('PRC_PHN_PROCESS_NUMBER-in_telefon_numarasi :'||in_telefon_numarasi);
    dbms_output.put_line('PRC_PHN_PROCESS_NUMBER-std_tel_no :'||std_tel_no);
    dbms_output.put_line('PRC_PHN_PROCESS_NUMBER-std_tel_no_s :'||std_tel_no_s);
    dbms_output.put_line('PRC_PHN_PROCESS_NUMBER-lbl_tel_no :'||lbl_tel_no);

    -- ev veya cep telefonu olduğunu kontrol ediyoruz
    QLICK.PRC_PHN_MOBILEHOME_CHCK(std_tel_no_s, lbl_alan_kodu1, lbl_alan_kodu2);
    dbms_output.put_line('PRC_PHN_MOBILEHOME_CHCK-std_tel_no :'||std_tel_no_s);
    dbms_output.put_line('PRC_PHN_MOBILEHOME_CHCK-lbl_alan_kodu1 :'||lbl_alan_kodu1);
    dbms_output.put_line('PRC_PHN_MOBILEHOME_CHCK-lbl_alan_kodu2 :'||lbl_alan_kodu2);
   
    -- dahili veya normal hat mı kontrolu yapıyoruz
    QLICK.PRC_PHN_EXTENSION_CHCK(in_telefon_numarasi, hat_flag, dahili_flag);
    dbms_output.put_line('PRC_PHN_EXTENSION_CHCK-in_telefon_numarasi :'||in_telefon_numarasi);
    dbms_output.put_line('PRC_PHN_EXTENSION_CHCK-hat_flag :'||hat_flag);
    dbms_output.put_line('PRC_PHN_EXTENSION_CHCK-dahili_flag :'||dahili_flag);
   
    -- yukarıdaki format vef flaglere göre telefon numarasının doğru formatına karar veriliyor
    QLICK.PRC_PHN_DECISION(lbl_tel_no, std_tel_no, std_tel_no_s, lbl_alan_kodu1, lbl_alan_kodu2, dahili_flag, hat_flag, dec_telefon_no1, dec_telefon_no2, dec_telefon_no3, dec_dahili_no_in);
    dbms_output.put_line('PRC_PHN_DECISION-lbl_tel_no :'||lbl_tel_no);
    dbms_output.put_line('PRC_PHN_DECISION-std_tel_no :'||std_tel_no);
    dbms_output.put_line('PRC_PHN_DECISION-std_tel_no_s :'||std_tel_no_s);
    dbms_output.put_line('PRC_PHN_DECISION-lbl_alan_kodu1 :'||lbl_alan_kodu1);
    dbms_output.put_line('PRC_PHN_DECISION-lbl_alan_kodu2 :'||lbl_alan_kodu2);
    dbms_output.put_line('PRC_PHN_DECISION-dahili_flag :'||dahili_flag);
    dbms_output.put_line('PRC_PHN_DECISION-hat_flag :'||hat_flag);
    dbms_output.put_line('PRC_PHN_DECISION-dec_telefon_no1 :'||dec_telefon_no1);
    dbms_output.put_line('PRC_PHN_DECISION-dec_telefon_no2 :'||dec_telefon_no2);
    dbms_output.put_line('PRC_PHN_DECISION-dec_telefon_no3 :'||dec_telefon_no3);
    dbms_output.put_line('PRC_PHN_DECISION-dec_dahili_no_in :'||dec_dahili_no_in);
   
   
    -- nihai telefon tablosunun alan kodu, alan kod tablolarında, alan kod haric kısmıda noise tablosunda var mı check edilir.
    QLICK.PRC_PHN_VALIDATION(dec_dahili_no_in, dec_telefon_no1, dec_telefon_no2, dec_telefon_no3, dec_dahili_no_out, telno1, telno2, telno3);
    dbms_output.put_line('PRC_PHN_VALIDATION-dec_dahili_no_in :'||dec_dahili_no_in);
    dbms_output.put_line('PRC_PHN_VALIDATION-dec_telefon_no1 :'||dec_telefon_no1);
    dbms_output.put_line('PRC_PHN_VALIDATION-dec_telefon_no2 :'||dec_telefon_no2);
    dbms_output.put_line('PRC_PHN_VALIDATION-dec_telefon_no3 :'||dec_telefon_no3);
    dbms_output.put_line('PRC_PHN_VALIDATION-dec_dahili_no_out :'||dec_dahili_no_out);
    dbms_output.put_line('PRC_PHN_VALIDATION-telno1 :'||telno1);
    dbms_output.put_line('PRC_PHN_VALIDATION-telno2 :'||telno2);
    dbms_output.put_line('PRC_PHN_VALIDATION-telno3 :'||telno3);
   
 END ;